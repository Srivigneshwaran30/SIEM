MODULE 7: Real-time or Continuous Log Monitoring

# âœ… ğŸ¯ Short Answer

âœ… Goal = Watch logs *as they grow*
âœ… Donâ€™t just process old logs.
âœ… Need *real-time / near-real-time* detection.

**Industry requirement:**

> Security teams want alerts the moment something bad happens.

---

# âœ… 1ï¸âƒ£ What is Real-time Monitoring?

âœ… SIEM continuously watches:

* Files (like /var/log/auth.log)
* Syslog (network UDP 514)

âœ… As new events arrive:

* Collector grabs them
* Parser parses
* Storage inserts
* Alerts Engine evaluates
* Alerts generated instantly

âœ… Result: Analyst is notified in seconds, not hours.

---

# âœ… 2ï¸âƒ£ Real-world Analogy

âœ… Think of **tail -f** in Linux.

```
tail -f /var/log/auth.log
```

âœ… As new lines are appended â†’ you see immediately.

âœ… SIEM does the same â†’ but also parses + alerts.

---

# âœ… 3ï¸âƒ£ What Inputs We Need to Watch Continuously

âœ… File inputs:

* Linux: /var/log/auth.log
* Web server: /var/log/nginx/access.log

âœ… Syslog inputs:

* UDP port 514 on localhost or network

âœ… Windows?

* Use agent to ship logs as syslog / files

âœ… SIEM collector listens continuously to both.

---

# âœ… 4ï¸âƒ£ MVP Monitoring Design

âœ… Our collector process:
âœ”ï¸ Watches log files (tail)
âœ”ï¸ Listens for syslog packets
âœ”ï¸ For each new line:

* Parse
* Store
* Evaluate rules
* Trigger alert if match

âœ… Runs forever until stopped.

---

# âœ… 5ï¸âƒ£ File Monitoring: Tailer

âœ… *Python approach:*

```python
with open('/var/log/auth.log') as f:
    f.seek(0, 2)  # Go to end
    while True:
        line = f.readline()
        if line:
            process_line(line)
        else:
            time.sleep(0.5)
```

âœ… Every time a new line is written â†’ our collector ingests it immediately.

---

# âœ… 6ï¸âƒ£ Syslog Monitoring: UDP Listener

âœ… *Python approach:*

```python
import socket

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.bind(("0.0.0.0", 514))
while True:
    data, addr = sock.recvfrom(1024)
    process_line(data.decode())
```

âœ… As soon as a device sends a syslog message â†’ our collector gets it.

---

# âœ… 7ï¸âƒ£ Multiplexed Input Sources

âœ… Advanced plan (still easy with Python):
âœ”ï¸ Watch multiple files
âœ”ï¸ Handle multiple network sources

âœ… Use:

* Threads
* Async
* Select/poll

âœ… Example:

* One thread per file tail
* One thread for syslog socket

---

# âœ… 8ï¸âƒ£ Continuous Processing Pipeline

âœ… For every new line:
âœ”ï¸ Collector â†’ Parser â†’ Storage â†’ Alerts

âœ… Realtime flow:

```
Log source (file/syslog)
    â†“
Collector
    â†“
Parser
    â†“
SQLite DB
    â†“
Alert Engine
    â†“
Alerts Table
```

âœ… Whole cycle: < 1 second

---

# âœ… 9ï¸âƒ£ MVP CLI Example

âœ… Start the collector:

```
python collector.py --config config.yaml
```

âœ… Collector runs forever.
âœ… Prints:

```
[INFO] Ingested new line from /var/log/auth.log
[INFO] Alert triggered: failed_login
```

---

# âœ… 10ï¸âƒ£ Config File Example

âœ… Define inputs in config:

```yaml
inputs:
  files:
    - /var/log/auth.log
    - /var/log/nginx/access.log
  syslog:
    port: 514
```

âœ… Easy for users to add/remove sources.

---

# âœ… 11ï¸âƒ£ MVP Alert Notifications

âœ… In CLI:

```
[ALERT] Rule: failed_login | IP: 192.168.1.10 | Time: 2025-07-09 12:30
```

âœ… Optional:

* Write to alert.log file
* Send email (later)
* Webhook (future)

---

# âœ… 12ï¸âƒ£ Why Real-time Monitoring Matters

âœ… Security teams can:

* Block IP immediately
* Investigate while attack is ongoing
* Prove compliance

âœ… Without it â†’ SIEM = Just log archive

---

# âœ… 13ï¸âƒ£ Advanced Future Ideas

âœ… 1ï¸âƒ£ Message Queues:

* Kafka
* RabbitMQ

âœ… 2ï¸âƒ£ Scaling:

* Multiple collectors
* Central storage

âœ… 3ï¸âƒ£ Event forwarders:

* NXLog / Filebeat â†’ our syslog

âœ… 4ï¸âƒ£ Enrichment:

* GeoIP lookup
* Threat intel

âœ… 5ï¸âƒ£ Correlation engine:

* Detect lateral movement
* Link multiple alerts

---

# âœ… 14ï¸âƒ£ MVP Design Goals for Real-time Monitoring

âœ… \[x] Tail files continuously
âœ… \[x] Listen for syslog continuously
âœ… \[x] Parse each line immediately
âœ… \[x] Insert into DB immediately
âœ… \[x] Evaluate rules immediately
âœ… \[x] Insert alerts immediately
âœ… \[x] Print alerts immediately

âœ… Outcome:
â­ Lightweight
â­ Fully offline
â­ Works on laptop

---

# âœ… â¤ï¸ Professional Summary

âœ… Real-time monitoring:
âœ”ï¸ Continuously watch logs
âœ”ï¸ Process on the fly
âœ”ï¸ Trigger alerts instantly

âœ… SIEM collector = always running process

âœ… Gives security teams:
â­ Fast detection
â­ Fast response
â­ Better security posture

---

# âœ… â¤ï¸ TL;DR for Machan

âœ… Collector process runs forever
âœ… Reads new logs as they arrive
âœ… Sends them to parser â†’ storage â†’ alert engine
âœ… Alerts generated in real time

âœ… Your SIEM becomes *ALIVE* â¤ï¸ğŸ”¥
