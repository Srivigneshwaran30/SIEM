 âœ… MODULE 6: SEARCH & REPORTS

**Goal**:
âœ… Search historical logs
âœ… Investigate alerts
âœ… Optional: Generate reports

> Without search = logs irunthalum use illa.
> Without reports = value puriyadhu to managers.

---

## âœ… 1ï¸âƒ£ SEARCH MODULE â€” Overview

âœ… SIEM user (security analyst) should be able to:

* Search logs using:

  * Keywords
  * Time range
  * Source
  * Specific field (like IP, method, path)

âœ… Main goals:
âœ”ï¸ Investigate incidents
âœ”ï¸ Hunt for threats
âœ”ï¸ Validate alerts

---

## âœ… 2ï¸âƒ£ Search CLI Commands (for our MVP)

### ğŸ” a) Search by keyword

```
python search.py --contains "Failed password"
```

âœ… Output:

```
[LOG ID: 12]
Source: authlog
Time: 2025-07-09 12:23:01
Raw: Jul 9 12:23:01 ubuntu sshd[1234]: Failed password for root from 192.168.1.10
```

---

### ğŸ” b) Search by field match

```
python search.py --field ip --value 192.168.1.10
```

âœ… Output:

```
[LOG ID: 22] Nginx log with same IP
[LOG ID: 23] SSH failure from that IP
```

---

### ğŸ” c) Search by time range

```
python search.py --start "2025-07-09 12:00" --end "2025-07-09 13:00"
```

âœ… Output:
All logs between those times

---

### ğŸ” d) Search by source type

```
python search.py --source authlog
```

---

## âœ… 3ï¸âƒ£ How It Works (Internally)

âœ… Your logs already in SQLite like this:

| id | timestamp           | raw\_log                                | parsed\_log (JSON)                     |
| -- | ------------------- | --------------------------------------- | -------------------------------------- |
| 12 | 2025-07-09 12:23:01 | "Failed password from 192.168.1.10 ..." | {"ip": "192.168.1.10", "event": "..."} |

âœ… You run a SQL query in Python:

```sql
SELECT * FROM logs WHERE raw_log LIKE '%Failed password%';
```

âœ… For field search:

```sql
SELECT * FROM logs WHERE json_extract(parsed_log, '$.ip') = '192.168.1.10';
```

âœ… Easy, flexible, and fast for MVP size.

---

## âœ… 4ï¸âƒ£ Output Format (CLI)

âœ… For each match:

```
====================
[Log ID: 12]
Source: authlog
Time: 2025-07-09 12:23:01
IP: 192.168.1.10
Event: Failed password for root
Raw: Jul 9 12:23:01 ubuntu sshd[...]
====================
```

âœ… Professional investigation experience ğŸ’¼

---

## âœ… 5ï¸âƒ£ Advanced Search Features (Future)

* Boolean logic (AND/OR)
* Regex match
* Saved queries
* Timeline view
* Search via Web UI

---

# ğŸ“Š MODULE 6.2: REPORTS (Optional in MVP, but plan it)

âœ… Reports = summarized views of logs or alerts.

âœ… Types:

* Daily alert summary
* Top attacker IPs
* Failed login count
* HTTP request trends

---

## âœ… Example Report Idea 1: Top 5 Alerted Rules

```sql
SELECT rule_name, COUNT(*) as count
FROM alerts
GROUP BY rule_name
ORDER BY count DESC
LIMIT 5;
```

âœ… Output:

```
Top Alerted Rules:
1. failed_login â€“ 45
2. sql_injection â€“ 12
3. ufw_block â€“ 5
```

---

## âœ… Example Report Idea 2: Top Source IPs

```sql
SELECT json_extract(parsed_log, '$.ip') as ip, COUNT(*)
FROM logs
GROUP BY ip
ORDER BY COUNT(*) DESC
LIMIT 5;
```

---

## âœ… Reports Output Format:

âœ… Console Table
âœ… CSV file (for email/share)
âœ… JSON (for frontend integration)

---

## âœ… MVP CLI Report Command (Idea)

```
python reports.py --type top_alerts --last 24h
```

---

## âœ… Future Upgrade Ideas for Reports

* PDF export
* Email scheduling
* Dashboards (with graphs)
* Incident timelines

---

# âœ… â¤ï¸ Professional Summary

### ğŸ” SEARCH:

* Search logs by keyword, field, time
* Output in CLI for investigations
* Uses SQLite queries under the hood

### ğŸ“Š REPORTS:

* Show trends in alerts/logs
* Exportable, shareable format
* Optional in MVP, must-have later

---

# âœ… â¤ï¸ TL;DR for Machan

âœ… Without search â†’ logs use illa
âœ… Without reports â†’ decision-makers value ah paakamatanga

âœ… Search = For analyst
âœ… Reports = For manager

---
