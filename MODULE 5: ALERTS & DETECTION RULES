 âœ… ğŸ¯ Short Answer

âœ… INPUT to Alerts Engine:
â­ Parsed, normalized log records from storage

âœ… OUTPUT:
â­ Alerts â†’ stored in DB â†’ user notification

---

# âœ… 1ï¸âƒ£ Why Alerts Matter

âœ… Without alerts, SIEM = just log storage.
âœ… Alerts = detection.
âœ… Security teams *react* based on alerts.

âœ… Goal: **â€œFind suspicious behavior in logs automatically.â€**

---

# âœ… 2ï¸âƒ£ What is a Detection Rule?

âœ… A rule = condition + action.
âœ… Simple logic:

```
IF log matches condition â†’ THEN alert
```

âœ… Example rule:

```
IF parsed_log.event CONTAINS "Failed password"
THEN generate alert with rule_name="failed_login"
```

âœ… Rules turn raw logs into security intelligence.

---

# âœ… 3ï¸âƒ£ Detection Rule Types

âœ… MVP Focus: **Simple keyword/regex match**
âœ… Future:
âœ”ï¸ Threshold rules (e.g. 5 failures in 1 minute)
âœ”ï¸ Correlation (across sources)
âœ”ï¸ ML-based anomaly detection

---

# âœ… 4ï¸âƒ£ Example MVP Rules

âœ… 1ï¸âƒ£ SSH brute-force:

```
Match: event contains "Failed password"
```

âœ… 2ï¸âƒ£ Web attack attempt:

```
Match: path contains "../"
```

âœ… 3ï¸âƒ£ SQL injection try:

```
Match: path contains "UNION SELECT"
```

âœ… 4ï¸âƒ£ Firewall block:

```
Match: event contains "UFW BLOCK"
```

âœ… These simple rules give big value.

---

# âœ… 5ï¸âƒ£ Our Rules Config Design

âœ… Rules in YAML or JSON file:

â­ Example `rules.yaml`

```yaml
rules:
  - name: failed_login
    source: authlog
    match_field: event
    match_type: contains
    match_value: "Failed password"

  - name: sql_injection
    source: nginx_access
    match_field: path
    match_type: contains
    match_value: "UNION SELECT"

  - name: directory_traversal
    source: nginx_access
    match_field: path
    match_type: contains
    match_value: "../"
```

âœ… Easy to update.
âœ… Startup friendly.

---

# âœ… 6ï¸âƒ£ Alerts Engine Flow

âœ… 1ï¸âƒ£ Load parsed logs from storage.
âœ… 2ï¸âƒ£ For each log:
âœ”ï¸ Determine source type.
âœ”ï¸ Load rules for that source.
âœ”ï¸ Check if log field matches condition.
âœ”ï¸ If match â†’ Insert alert in alerts table.

âœ… 3ï¸âƒ£ Store alert with:

* Rule name
* Matched log ID
* Time

---

# âœ… 7ï¸âƒ£ Alerts DB Table Schema

| Column        | Type      | Example               |
| ------------- | --------- | --------------------- |
| id            | INTEGER   | 1                     |
| rule\_name    | TEXT      | "failed\_login"       |
| log\_id       | INTEGER   | 42                    |
| triggered\_at | TIMESTAMP | "2025-07-09 12:26:15" |

âœ… Links back to logs table â†’ investigation.

---

# âœ… 8ï¸âƒ£ CLI Command Examples

âœ… List Alerts:

```
python alerts.py --list
```

â­ Output:

```
ID  Rule         Time
1   failed_login 2025-07-09 12:23
2   sql_injection 2025-07-09 12:26
```

âœ… View Alert Details:

```
python alerts.py --show 2
```

â­ Output:

```
Rule: sql_injection
Matched Log:
192.168.1.5 - - [09/Jul/2025:12:45:01 +0000] "GET /index.php?id=1 UNION SELECT password FROM users"
```

---

# âœ… 9ï¸âƒ£ Example Rule Evaluation in Code

âœ… Simple Python pseudocode:

```python
for log in parsed_logs:
    for rule in rules:
        if log['source'] == rule['source']:
            field_value = log.get(rule['match_field'], "")
            if rule['match_type'] == "contains" and rule['match_value'] in field_value:
                insert_alert(rule['name'], log['id'])
```

âœ… Very understandable.
âœ… Easy to extend.

---

# âœ… 10ï¸âƒ£ Alerting Strategies for MVP

âœ… CLI-only for now
âœ”ï¸ User runs command to see alerts

âœ… Later:
âœ”ï¸ Email alerts
âœ”ï¸ Slack/webhook
âœ”ï¸ Web UI dashboard

âœ… Start simple â†’ plan for scale.

---

# âœ… 11ï¸âƒ£ Future Detection Rule Ideas

â­ Threshold rules:

```
If 5 failed logins from same IP in 1 minute
```

â­ Correlation rules:

```
SSH login success after multiple failures
```

â­ ML / statistical:

```
Anomaly score for rare events
```

â­ External threat feeds:

```
Check if source IP in threat intel
```

âœ… These are advanced but fit our design.

---

# âœ… 12ï¸âƒ£ MVP Alerts Engine Design

âœ… Load logs from DB
âœ… Apply rules
âœ… Store alerts in DB
âœ… CLI view

âœ… Configurable rules
âœ… Works offline
âœ… Lightweight

---

# âœ… â¤ï¸ Professional Summary

âœ… *Input to Alerts Module:*
âœ”ï¸ Parsed, normalized logs from DB

âœ… *Processing:*
âœ”ï¸ Check each log against detection rules

âœ… *Output:*
âœ”ï¸ Alerts inserted into DB
âœ”ï¸ CLI view for analyst

âœ… *Purpose:*
âœ”ï¸ Notify security team about threats

---

# âœ… â¤ï¸ TL;DR for You

â­ Collector â†’ Parser â†’ Storage â†’ Alerts

âœ… Collector: gets logs
âœ… Parser: structures logs
âœ… Storage: saves logs
âœ… Alerts: finds security events

âœ… Our project = a mini Splunk or Graylog â¤ï¸

---

# âœ… â¤ï¸ Real Startup Pitch Line

âœ… â€œOur SIEM detects security events with customizable rules, generating actionable alerts for rapid response.â€
