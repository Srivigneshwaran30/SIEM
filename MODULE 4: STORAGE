 âœ… ğŸ¯ Short Answer

âœ… **Input to Storage:**
â­ Parsed logs (JSON)
â­ Raw logs (original line)

âœ… **Output from Storage:**
â­ Searchable logs
â­ Alerts linked to logs
â­ Reports (future)

---

# âœ… 1ï¸âƒ£ Purpose of Storage

âœ… Store *all collected logs* for:

* Search
* Correlation
* Alerts
* Compliance/audit

âœ… Must be:

* Reliable
* Searchable
* Tamper-evident (for advanced)

---

# âœ… 2ï¸âƒ£ Storage Requirements for Our MVP

âœ… Simple
âœ… Local (single laptop support)
âœ… Easy to query
âœ… Portable

âœ… Industry equivalents:

* ElasticSearch (heavy)
* Splunk Indexers (heavy)

âœ… For us:
â­ SQLite â€” perfect for MVP

* Lightweight
* File-based
* No server setup
* Works on any OS

---

# âœ… 3ï¸âƒ£ Our Storage Design

â­ Weâ€™ll use a local SQLite DB file:
âœ… `siem.db`

â­ Contains **2 main tables**:

---

âœ… **(A) Logs Table**
Stores:

* raw log line
* parsed JSON
* source info
* timestamp

âœ… Example Schema:

| Column       | Type      | Example                            |
| ------------ | --------- | ---------------------------------- |
| id           | INTEGER   | 1                                  |
| raw\_log     | TEXT      | "Jul 9 12:23:01 ubuntu sshd\[...]" |
| parsed\_log  | JSON      | {"timestamp": "...", "ip": "..."}  |
| source       | TEXT      | "authlog"                          |
| received\_at | TIMESTAMP | "2025-07-09 12:25:01"              |

âœ… Advantages:
â­ Raw log always kept
â­ Parsed fields easy to query

---

âœ… **(B) Alerts Table**
Stores:

* which rule triggered
* which log entry triggered it
* time of alert

âœ… Example Schema:

| Column        | Type      | Example               |
| ------------- | --------- | --------------------- |
| id            | INTEGER   | 1                     |
| rule\_name    | TEXT      | "failed\_login"       |
| log\_id       | INTEGER   | 42                    |
| triggered\_at | TIMESTAMP | "2025-07-09 12:26:15" |

âœ… Links back to logs â†’ investigator can see context.

---

âœ… Optional later:
âœ”ï¸ Enrichment table
âœ”ï¸ User accounts table
âœ”ï¸ Threat intel table

---

# âœ… 4ï¸âƒ£ Storage Flow

âœ… How logs move into storage:

```
+-------------+       +--------+       +----------+
| Collector   |  -->  | Parser |  -->  | Storage  |
+-------------+       +--------+       +----------+

Collector reads file/syslog â†’ 
Parser parses line â†’ 
Storage inserts raw + parsed
```

âœ… Alerts are triggered separately by rules engine:

```
Parsed log â†’ Rules â†’ If match â†’ Insert alert
```

---

# âœ… 5ï¸âƒ£ Example: Inserted Data

âœ… **Logs Table Row:**

| id | raw\_log                          | parsed\_log                                      | source  | received\_at        |
| -- | --------------------------------- | ------------------------------------------------ | ------- | ------------------- |
| 1  | Jul 9 12:23:01 ubuntu sshd\[...]" | {"timestamp": "...", "event": "Failed password"} | authlog | 2025-07-09 12:23:01 |

âœ… **Alerts Table Row:**

| id | rule\_name    | log\_id | triggered\_at       |
| -- | ------------- | ------- | ------------------- |
| 1  | failed\_login | 1       | 2025-07-09 12:23:02 |

---

# âœ… 6ï¸âƒ£ Storage Tech Choice

âœ… **Why SQLite?**
âœ”ï¸ No external server
âœ”ï¸ Works on Windows/Linux/Mac
âœ”ï¸ Single .db file = portable
âœ”ï¸ Easy CLI inspection
âœ”ï¸ Supports JSON fields

âœ… Example Python integration:

```python
import sqlite3
conn = sqlite3.connect('siem.db')
cursor = conn.cursor()
cursor.execute("INSERT INTO logs (raw_log, parsed_log, source) VALUES (?, ?, ?)", (raw, json.dumps(parsed), source))
```

âœ… Search:

```python
cursor.execute("SELECT * FROM logs WHERE parsed_log LIKE ?", ("%192.168.1.10%",))
```

---

âœ… **Industry Example (for later):**
âœ”ï¸ ElasticSearch
âœ”ï¸ PostgreSQL with JSONB
âœ”ï¸ Cloud logging stores

âœ… We design for SQLite first â†’ easy to swap backend later.

---

# âœ… 7ï¸âƒ£ CLI Command Examples

âœ… Insert:

```
python collector.py --config config.yaml
```

âœ… View Alerts:

```
python alerts.py --list
```

â­ Output:

```
ID  Rule         Time
1   failed_login 2025-07-09 12:23
```

âœ… Search Logs:

```
python search.py --contains "Failed password"
```

â­ Output:

```
ID  Source   Timestamp               Raw
1   authlog  2025-07-09 12:23:01    "Jul 9 12:23:01 ubuntu sshd[...]: Failed password"
```

---

# âœ… 8ï¸âƒ£ Retention Policy Plan (MVP)

âœ… Simple for now:

* Keep all logs
* No auto-delete

âœ… Later:

* Configurable retention
* Delete logs older than N days

âœ… Advanced:

* Archive to cloud
* Hash chains for tamper-proof

---

# âœ… 9ï¸âƒ£ Storage Challenges

âœ… High volume â†’ DB size grows
âœ… Query performance
âœ… Tamper-evidence
âœ… Backup & restore

âœ… Not our MVP priority â†’ plan for later.

---

# âœ… 10ï¸âƒ£ Our MVP Storage Goals

âœ… \[x] Store raw logs
âœ… \[x] Store parsed logs (JSON)
âœ… \[x] Store alerts
âœ… \[x] Search logs
âœ… \[x] CLI access

â­ Advanced (future):

* Web dashboard
* Graphs
* Indexing for speed
* Distributed storage

---

# âœ… â¤ï¸ Professional Summary for You

â­ INPUT:
âœ… raw\_log (from collector)
âœ… parsed\_log (from parser)

â­ STORED:
âœ… logs table
âœ… alerts table

â­ OUTPUT:
âœ… Searchable logs
âœ… Alerts
âœ… Reports (later)

---

# âœ… â¤ï¸ TL;DR for Machan

âœ… *Collector* reads logs
âœ… *Parser* structures logs
âœ… *Storage* keeps:
âœ”ï¸ raw
âœ”ï¸ parsed
âœ”ï¸ alerts

âœ… *Query / Search* â†’ forensic investigation

---

âœ… This is EXACTLY how real SIEM systems like Splunk, Graylog, Elastic SIEM work â€” just bigger and fancier!

---
